# gui_t13.py

import tkinter as tk
import sys
from t13_core import T13Engine

# Ù†Ù…ÙˆÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù‡Ø³ØªÙ‡â€ŒÛŒ Ù…Ø±Ú©Ø²ÛŒ
ai = T13Engine(user_name="Erfan")
options = ["Ø§Ø¯Ø§Ù…Ù‡ Ù¾Ø±ÙˆÚ˜Ù‡", "Ø§Ø³ØªØ±Ø§Ø­Øª", "ØªØ¹ÙˆÛŒÙ‚"]

# Ú©Ù„Ø§Ø³ Ø¨Ø±Ø§ÛŒ Ø±ÛŒØ¯Ø§ÛŒØ±Ú©Øª Ø®Ø±ÙˆØ¬ÛŒ print Ø¨Ù‡ Text ÙˆÛŒØ¬Øª
class RedirectText:
    def __init__(self, widget):
        self.widget = widget

    def write(self, string):
        self.widget.insert(tk.END, string)
        self.widget.see(tk.END)

    def flush(self):
        pass

# ØªØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø±Ø§ÛŒ ØªÙˆØ§Ø¨Ø¹ Ø¨Ø§ Ù†Ù…Ø§ÛŒØ´ Ø®Ø±ÙˆØ¬ÛŒ Ø¯Ø± GUI
def run_with_output(fn):
    output_text.delete(1.0, tk.END)
    sys.stdout = RedirectText(output_text)
    try:
        fn()
    except Exception as e:
        print(f"âš ï¸ Ø®Ø·Ø§: {e}")
    finally:
        sys.stdout = sys.__stdout__

# Ø®ÙˆØ§Ù†Ø¯Ù† Ù…Ù‚Ø§Ø¯ÛŒØ± ÙˆØ§Ø±Ø¯Ø´Ø¯Ù‡ ØªÙˆØ³Ø· Ú©Ø§Ø±Ø¨Ø±
def get_user_feelings():
    return {
        "joy": int(entry_joy.get() or 5),
        "stress": int(entry_stress.get() or 5),
        "hope": int(entry_hope.get() or 5),
        "fear": int(entry_fear.get() or 5),
        "energy": int(entry_energy.get() or 5)
    }

# Ø§Ø¬Ø±Ø§ÛŒ Ù‡Ù…â€ŒØ²Ù…Ø§Ù† Ú©Ù„ Ø³ÛŒØ³ØªÙ… Ø¨Ø§ Ø§Ø­Ø³Ø§Ø³Ø§Øª Ú©Ø§Ø±Ø¨Ø±
def run_custom_all():
    feelings = get_user_feelings()
    run_with_output(lambda: ai.run_all(feelings, options))

# Ø³Ø§Ø®ØªØ§Ø± Ø§ØµÙ„ÛŒ Ø±Ø§Ø¨Ø·
root = tk.Tk()
root.title("Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ T13.3 â€“ Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ ØªÙˆØ³Ø· Ø¹Ø±ÙØ§Ù†")
root.geometry("700x750")
root.configure(bg="#1e1e1e")

# ØªÛŒØªØ±
title = tk.Label(
    root,
    text="ğŸ§  Ø³ÛŒØ³ØªÙ… Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ T13.3",
    font=("Tahoma", 18, "bold"),
    bg="#1e1e1e",
    fg="#00cc99"
)
title.pack(pady=10)

# ÙØ±Ù… ÙˆØ±ÙˆØ¯ÛŒ Ø§Ø­Ø³Ø§Ø³Ø§Øª
form_frame = tk.Frame(root, bg="#1e1e1e")
form_frame.pack(pady=10)

labels = ["Ø´Ø§Ø¯ÛŒ", "Ø§Ø³ØªØ±Ø³", "Ø§Ù…ÛŒØ¯", "ØªØ±Ø³", "Ø§Ù†Ø±Ú˜ÛŒ"]
entries = []

for i, text in enumerate(labels):
    tk.Label(
        form_frame,
        text=text,
        font=("Tahoma", 10),
        fg="white",
        bg="#1e1e1e"
    ).grid(row=0, column=i, padx=5)
    entry = tk.Entry(form_frame, width=5, font=("Tahoma", 10))
    entry.grid(row=1, column=i, padx=5)
    entries.append(entry)

entry_joy, entry_stress, entry_hope, entry_fear, entry_energy = entries

# Ø¯Ú©Ù…Ù‡ Ø§Ø¬Ø±Ø§ÛŒ Ú©Ø§Ù…Ù„ Ø¨Ø§ Ù…Ù‚Ø§Ø¯ÛŒØ± Ú©Ø§Ø±Ø¨Ø±
tk.Button(
    root,
    text="ğŸš€ Ø§Ø¬Ø±Ø§ÛŒ Ú©Ø§Ù…Ù„ Ø¨Ø§ Ø§Ø­Ø³Ø§Ø³Ø§Øª Ù…Ù†",
    command=run_custom_all,
    bg="#006699",
    fg="white",
    font=("Tahoma", 12),
    width=40
).pack(pady=5)

# Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯ÛŒÚ¯Ø±
btn_frame = tk.Frame(root, bg="#1e1e1e")
btn_frame.pack(pady=5)

buttons = [
    ("ğŸ§  Ø­Ø§ÙØ¸Ù‡", lambda: run_with_output(ai.run_memory)),
    ("ğŸ“Š ØªØ­Ù„ÛŒÙ„ Ø§Ø­Ø³Ø§Ø³Ø§Øª", lambda: run_with_output(lambda: ai.run_emotion(get_user_feelings()))),
    ("ğŸ§­ ØªØµÙ…ÛŒÙ…â€ŒÚ¯ÛŒØ±ÛŒ", lambda: run_with_output(lambda: ai.run_decision(options))),
    ("ğŸ­ Ø±ÙØªØ§Ø±", lambda: run_with_output(ai.run_behavior)),
    ("ğŸ§¬ Ø§Ø±ØªÙ‚Ø§", lambda: run_with_output(ai.run_upgrade)),
    ("ğŸ©º Ø³Ù„Ø§Ù…Øª Ø³ÛŒØ³ØªÙ…", lambda: run_with_output(ai.run_health)),
    ("ğŸ“ˆ ØªØ­Ù„ÛŒÙ„ Ø±ÙˆÙ†Ø¯", lambda: run_with_output(ai.run_trend_analysis)),
    ("ğŸ‡ Ø¯Ù†ÛŒØ§Ø³Ø§Ø²ÛŒ Ùˆ Ø§ÛŒØ¯Ù‡", lambda: run_with_output(ai.run_multiverse))
]

for text, cmd in buttons:
    tk.Button(
        btn_frame,
        text=text,
        command=cmd,
        bg="#333333",
        fg="white",
        font=("Tahoma", 10),
        width=30
    ).pack(pady=3)

# ÙˆÛŒØ¬Øª Ù…ØªÙ†ÛŒ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø®Ø±ÙˆØ¬ÛŒâ€ŒÙ‡Ø§
output_text = tk.Text(
    root,
    height=25,
    bg="#000000",
    fg="#00ff00",
    font=("Consolas", 10),
    insertbackground="white"
)
output_text.pack(fill="both", expand=True, padx=10, pady=10)

root.mainloop()
